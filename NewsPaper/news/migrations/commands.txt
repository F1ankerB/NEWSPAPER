from django.contrib.auth.models import User
from news.models import *
user1 = User.objects.create_user('john')
user2 = User.objects.create_user('alice')
author1 = Author.objects.create(user=user1)
author2 = Author.objects.create(user=user2)
cat1 = Category.objects.create(name='Sport')
cat2 = Category.objects.create(name='Politics')
cat3 = Category.objects.create(name='Science')
cat4 = Category.objects.create(name='Economics')
post1 = Post.objects.create(author=author1, post_type='article', title='Football', text='some text...')
post2 = Post.objects.create(author=author2, post_type='article', title='Politics', text='some text...')
post3 = Post.objects.create(author=author1, post_type='news', title='Science news', text='some text...')
post1.categories.add(cat1)
post2.categories.add(cat2, cat3)
post3.categories.add(cat3)
com1 = Comment.objects.create(post=post1, user=user2, text='comment 1')
com2 = Comment.objects.create(post=post1, user=user1, text='comment 2')
com3 = Comment.objects.create(post=post2, user=user1, text='comment 3')
com4 = Comment.objects.create(post=post3, user=user2, text='comment 4')
post1.like(); post2.like(); post2.dislike(); post3.dislike()
com1.like(); com3.like(); com3.dislike(); com4.dislike()
author1.update_rating()
author2.update_rating()
print(Author.objects.all().order_by('-rating')[0].user.username)
best_post = Post.objects.all().order_by('-rating')[0]
print(best_post.created_at, best_post.author.user.username, best_post.rating, best_post.title, best_post.preview())
for c in Comment.objects.filter(post=best_post):
  print(c.created_at, c.user.username, c.rating, c.text)
